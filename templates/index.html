{% extends "base.html" %} {% block content %}
<section class="card site-card border-0 transmission-hero mb-4">
    <div class="card-body p-4 p-md-5">
        <div class="transmission-grid">
            <div>
                <p class="hero-kicker">[Begin Transmission]</p>
                <h1 class="display-6 fw-semibold mb-3">Galactic Pirate Radio</h1>
                <p class="hero-subtext mb-4">
                    A quiet signal at the edge of charted space. Tune in for broadcasts, archives, and transmission logs
                    from a hidden outpost.
                </p>
                <div class="hero-actions">
                    <a class="btn btn-outline-secondary px-4" href="/software">Software</a>
                </div>
            </div>
            <div class="signal-panel">
                <div class="signal-emblem signal-emblem-portrait">
                    <div class="signal-logo-frame">
                        <img
                            class="signal-logo"
                            src="/static/images/gpr.png"
                            alt="Galactic Pirate Radio logo"
                            loading="lazy"
                        />
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="transmission-log p-3 p-md-4">
    <div class="log-header mb-3">
        <span class="log-label">[Recent Activity]</span>
        <span class="log-meter">
            Signal Strength:
            <span id="signalStrengthBars">███████░░░</span>
            <span id="signalStrengthValue">78%</span>
        </span>
    </div>
    {% for transmission in recent_transmissions %}
    <div class="log-entry {% if !loop.last %}mb-2{% endif %}">
        <div class="log-time mb-1">{{ transmission.time_label }}</div>
        <p class="mb-0">{{ transmission.message }}</p>
    </div>
    {% endfor %}
</section>
<script>
    (() => {
        const barsEl = document.getElementById("signalStrengthBars");
        const valueEl = document.getElementById("signalStrengthValue");
        if (!barsEl || !valueEl) return;

        let strength = 78;
        const min = 72;
        const max = 86;
        const stepOptions = [-2, -1, 0, 1, 2];

        const render = () => {
            const filled = Math.max(0, Math.min(10, Math.round(strength / 10)));
            barsEl.textContent = `${"█".repeat(filled)}${"░".repeat(10 - filled)}`;
            valueEl.textContent = `${strength}%`;
            const footerValueEl = document.getElementById("footerSignalStrengthValue");
            if (footerValueEl) {
                footerValueEl.textContent = `${strength}%`;
            }
        };

        const tick = () => {
            const step = stepOptions[Math.floor(Math.random() * stepOptions.length)];
            strength = Math.max(min, Math.min(max, strength + step));
            render();
        };

        render();
        setInterval(tick, 3500);
    })();
</script>
{% endblock %}
